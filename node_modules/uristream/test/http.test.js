var http = require('http'),
    fs = require('fs');

var uristream = require('../uristream');

var agent = new http.Agent({ keepAlive: true });

var file = fs.createReadStream(__dirname + '/index.m3u8');

uristream('http://vu01.servers.m-dn.net/live.m3u8', { cache: { meta: {
  url: 'http://vu01.servers.m-dn.net/live.m3u8',
  mime: 'application/vnd.apple.mpegurl',
  modified: new Date('Tue, 28 Jul 2015 14:39:05 GMT'),
  size: 169
}, data: file } })
//uristream('http://google.com/', { agent: agent })
//uristream('https://wmn-api.m-dn.net/channels/dr1/programs')
  .on('error', function(err) {
    console.error('error', err.stack);
  })
  .on('meta', function(meta, stale) {
    console.error('meta', meta, stale);
  })
  .on('end', function() {
    console.error('end');
  })
  .pipe(process.stdout);
